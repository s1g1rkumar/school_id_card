<div class="flex align-items-center justify-content-center"
  style="min-height: 100vh; padding-bottom: 50px; padding-top: 50px">
  <div style="max-width: 900px">
    <div class="w-full">
      <!-- <p-divider></p-divider> -->
      <h2 class="flex align-items-center justify-content-center pb-3" style="color: #317874">
        School Regisration Application Form
      </h2>
    </div>
    <br />
    <div class="flex align-items-center justify-content-center">
      <!-- <div class="form-container border-1 border-primary border-round col-12 p-5 surface-card"> -->


      <form [formGroup]="myForm" (submit)="formSubmit()">

        <div class="field col-12 p-4 border-round surface-card shadow-1 grid mt-8 border-primary border-1"
        *ngIf="step==1" formGroupName="organisationDetails">
        <div class="col-12" >
          <div class="-mt-8 mb-4 text-center relative">
            <div class="absolute" style="bottom: 0; right: 42%">
              <p-button icon="pi pi-camera" styleClass="p-button-sm p-button-rounded "
                (click)="hiddenfileinput.click()"></p-button>
            </div>
            <div *ngIf="pictureUrl; else elseBlock">
              <img [src]="pictureUrl" alt="profile_pic" class="w-10rem h-10rem border-circle"
                style="border: 8px solid #eff3f8" />
            </div>
            <ng-template #elseBlock>
              <img src="https://www.adaptivewfs.com/wp-content/uploads/2020/07/logo-placeholder-image.png"
                alt="profile_pic" class="w-10rem h-10rem border-circle" style="border: 8px solid #eff3f8" />
            </ng-template>
          </div>
          <!-- <button (click)="hiddenfileinput.click()">Image</button> -->
        </div>
        <div class="col-12 md:col-6">
          <label class="title_color">Organisation Code*</label>
          <input type="text" pInputText formControlName="code" class="w-full" />
        </div>
        <div class="col-12 md:col-6">
          <label class="title_color">Organisation Name*</label>
          <input type="text" pInputText formControlName="name" class="w-full" />
        </div>
        <div class="col-12 md:col-6">
          <label class="title_color">Board/Unit*</label>
          <input type="text" pInputText formControlName="board" class="w-full" />
        </div>
        <div class="col-12 md:col-6">
          <label class="title_color">Branch*</label>
          <input type="text" pInputText formControlName="branch" class="w-full" />
        </div>

        <div class="col-12 md:col-6 mt-3">
          <label class="title_color">Phone*</label>
          <p-inputMask mask="9999999999" placeholder="999-999-9999" formControlName="phone"
            styleClass="w-full"></p-inputMask>
        </div>
        <div class="col-12 md:col-6 mt-3">
          <label class="title_color">Website*</label>
          <input type="url" pInputText formControlName="website" class="w-full" />
        </div>

        <div class="col-12 md:col-6 mt-3">
          <label class="title_color">Pincode*</label>
          <p-inputMask mask="999999" placeholder="999-999" formControlName="pincode"
            styleClass="w-full"></p-inputMask>
        </div>

        <div class="col-12 md:col-6 mt-3">
          <label class="title_color">Email*</label>
          <input type="email" pInputText formControlName="email" class="w-full" />
        </div>
        <div class="col-12 md:col-12 mt-3">
          <label class="title_color">Address*</label>
          <textarea rows="5" cols="30" pInputTextarea formControlName="address"
            class="w-full border border-solid border-400 border-round"></textarea>
        </div>

        <div class="field col-12 p-4 border-round surface-card shadow-1 grid hidden">
          <div class="col-12 md:col-6">
            <label class="title_color">Upload profile picture*</label>
            <input type="file" style="display: none" (change)="fileUpload($event)" required accept="image/*"
              data-max-size="2048" #hiddenfileinput
              class="file_upload text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full" />
            <!-- <span class="text-red-500" *ngIf="transportation && transportation.invalid && transportation.touched">Transportation cannot be empty.</span> -->
          </div>
        </div>
      </div>

        <div class="flex align-items-center justify-content-center gap-4" *ngIf="step==2">
          <div formArrayName="sections">
            <div *ngFor="
                  let section of myForm.get('sections').controls;
                  let s = index
                " class="form-container border-1 border-primary border-round col-12 p-5 surface-card my-3">
              <div [formGroupName]="s" class=" mb-1 px-2">
                <div class="grid gap-1 ">
                  <input type="text" pInputText formControlName="section_name" placeholder="section title"
                    class="col-5 border-none text-3xl" />
                  <input type="text" pInputText formControlName="section_desc" placeholder="Section description"
                    class="col-5 border-none text-2xl" />
                  <div class="col-1 ">
                    <div class="flex justify-content-evenly ">
                      <span class="pi pi-plus " style="color:#3b82f6" (click)="addItem(s)"></span>
  
                    </div>
  
                  </div>
  
                </div>
  
                <p-divider class="w-full"></p-divider>
                <div formArrayName="items" class="w-full">
                  <div *ngFor="
                        let item of myForm.get(['sections', s, 'items']).controls;
                        let i = index
                      " class="w-full">
                    <div [formGroupName]="i" class=" p-1 my-2 w-full">
                      <div class="border border-1 border-round border-400 p-2 mt-2 grid">
                        <div class="col-5">
                          <input type="text" pInputText placeholder="label name" formControlName="field_name"
                            class="w-full" />
                        </div>
                        <div class="col-3 ">
                          <p-dropdown formControlName="field_type" [options]="fieldTypeList" optionLabel="label"
                            styleClass="w-full" [group]="true" (onChange)="onTypeChange($event.value)"></p-dropdown>
                        </div>
                        <div class="col-1">
                          <p-inputSwitch formControlName="field_required" styleClass="w-full"></p-inputSwitch>
                        </div>
  
                        <div class="col-3">
                          <div class="flex align-items-end justify-content-between">
                            <span class="pi pi-times-circle " style="color: red" (click)="removeItem(s,i)"></span>
                            <div class="card flex justify-content-center">
                              <p-toast></p-toast>
                              <p-menu #menu [model]="items" [popup]="true"></p-menu>
                              <i class="pi pi-ellipsis-v" style="color: #3b82f6" (click)="menu.toggle($event)"></i>
                            </div>
                          </div>
                        </div>
  
  
  
                        <div class="dependent-fields my-2 col-12"
                          *ngIf=" this.myForm.get('sections').get([s]).get('items').get([i]).get('field_type').value.value === 'dropdown' || this.myForm.get('sections').get([s]).get('items').get([i]).get('field_type').value.value === 'checkbox' || this.myForm.get('sections').get([s]).get('items').get([i]).get('field_type').value.value === 'radio' ">
                          <div formArrayName="field_options">
                            <div *ngFor="
                           let item of myForm.get(['sections', s, 'items',i,'field_options']).controls;
                           let fo = index" class="">
                              <div [formGroupName]="fo" class=" my-2 grid">
                                <span class="p-input-icon-left">
                                  <i
                                    [class]="'pi ' +showIcons(this.myForm.get('sections').get([s]).get('items').get([i]).get('field_type').value.value)"></i>
                                  <input type="text" pInputText formControlName="label"
                                    class="border border-none border-bottom-1" [placeholder]="'Option ' + (fo+1) " />
                                </span>
                                <!-- <input type="text" pInputText placeholder="option label" formControlName="label"
                                  class="col-5 border border-none border-bottom-1" /> -->
                                <!-- <input type="text" pInputText placeholder="option value" formControlName="value"
                                  class="col-5" /> -->
                                <div class="col-2">
                                  <span class="pi pi-plus " style="color: blue" (click)="addOptions(s,i,fo)"></span>
                                  <span class="pi pi-times-circle " style="color: red"
                                    (click)="removeOptions(s,i,fo)"></span>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
  
                        <input type="text" pInputText formControlName="field_description" placeholder="label description"
                          class="col-12" />
                          <!-- <p>{{this.myForm.get('sections').get([s]).get('items').get([i]) | json}}</p> -->
                        <div class="mt-2 border border-1 w-full grid">
                          <div class="col-3">
                            <p-dropdown formControlName="field_validation_type" [options]="validationTypeList"
                              optionLabel="label" styleClass="w-full"></p-dropdown>
                          </div>
                          <div class="col-5 flex gap-2"    *ngIf="checkLengthAndRange(this.myForm.get('sections').get([s]).get('items').get([i]).get('field_validation_type').value.value)">
                            <!-- <p-dropdown
                              formControlName="field_validation_sub_type" [options]="lengthTypeList" optionLabel="label"
                              styleClass="w-full"></p-dropdown> -->
                              <div class="p-inputgroup">
                                <span class="p-inputgroup-addon">Min</span>
                                <input type="text" pInputText placeholder="Number" />
                            </div>
                            <div class="p-inputgroup">
                              <span class="p-inputgroup-addon">Max</span>
                              <input type="text" pInputText placeholder="Number" />
                          </div>
                          </div>
                          <div
                          *ngIf="this.myForm.get('sections').get([s]).get('items').get([i]).get('field_validation_type').value.value === 'expression'"
                            [class]="this.myForm.get('sections').get([s]).get('items').get([i]).get('field_validation_type').value.value === 'length'?'col-2':'col-4'">
                            <input type="text" pInputText formControlName="field_validation_value"
                              [placeholder]="this.myForm.get('sections').get([s]).get('items').get([i]).get('field_validation_type').value.value === 'length'?'number':'pattern'" class="w-full" />
                          </div>
                          <div class="col">
                            <input type="text" pInputText formControlName="field_validation_message"
                              placeholder="error message" class="w-full" />
                          </div>
  
                        </div>
                      </div>
  
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="flex-row gap-1">
            <p-button icon="pi pi-plus" styleClass="p-button-rounded p-button-text p-button-raised border shadow-4"
              (click)="addSection()"></p-button>
            <p-button icon="pi pi-trash" styleClass="p-button-rounded p-button-text p-button-raised border shadow-4 mt-2"
              (click)="removeSection()"></p-button>
          </div>
        </div>

        <div class="field col-12 p-4 border-round surface-card shadow-1 grid mt-5 border-primary border-1"
        *ngIf="step==3">
        <div class="align-items-center justify-content-center col-12">
          <h4 class="title_color">form theme configuration</h4>
          <p-divider></p-divider>
        </div>
        <div formGroupName="themeDetails" class="col-12 grid mt-2">
          <div class="md:col-6 sm:col-12">
            <label class="title_color">Primary Font</label>
            <input type="text" pInputText formControlName="primary_font"
              class="w-full text-base text-color surface-overlay" />
          </div>
          <div class="md:col-6 sm:col-12">
            <label class="title_color">Secondary Font</label>
            <input type="text" pInputText formControlName="secondary_font"
              class="w-full text-base text-color surface-overlay" />
          </div>
          <div class="col-6 flex align-items-center justify-content-evenly">
            <label class="title_color">Primary Color</label>
            <p-colorPicker formControlName="primary_color"></p-colorPicker>
          </div>
          <div class="col-6 flex align-items-center justify-content-evenly">
            <label class="title_color">Secondary Color</label>
            <p-colorPicker formControlName="secondary_color"></p-colorPicker>
          </div>

          <div class="col-6 flex align-items-center justify-content-evenly">
            <label class="title_color">Theme Color</label>
            <p-colorPicker formControlName="theme_color"></p-colorPicker>
          </div>
        </div>
      </div>

       
        <div class="flex align-items-center justify-content-center gap-3">
          <p-button type="button" label="Previous" severity="warning" (onClick)="gotoPrevious()" *ngIf="step !=1" ></p-button>
          <p-button type="button" label="Next" severity="help" (onClick)="gotoNext()" *ngIf="step !=3" [disabled]="!isFormGroupValid()"></p-button>
          <p-button type="submit" label="Submit" [disabled]="myForm.invalid"></p-button>
          <!-- <p-button label="test"[disabled]="!isFormGroupValid()"></p-button> -->
        </div>
      </form>
     

    </div>

  </div>
  <!-- <div *ngIf="isPreview">
        <app-preview [data]="data" (dataEvent)="editModeHandler()" (submitClearData)="submitClearData()" ></app-preview>
      </div> -->
</div>
<!-- </div> -->